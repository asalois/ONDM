%% scrip to test gpu performance
clc
clear all
runs = 30;
times = zeros(4,12*runs);
    
for k = 1:12
    array_size = 2^k;
    for i = k:k*runs
        % cpu fft test
        tic;
        M = rand(array_size);
        cpu = fft(M);
        inv = ifft(cpu);
        time_cpu = toc;
        
        % gpu fft test
        tic;
        G = gpuArray(M);
        gpu = fft(G);
        invg = ifft(G);
        time_gpu = toc;
        
        speed_up = time_cpu / time_gpu;
        
        times(1,i) = time_cpu;
        times(2,i) = time_gpu;
        times(3,i) = speed_up;
        times(4,i) = array_size;
    end
end

%%
writematrix(times', 'gpu_vs_cpu.csv');
figure()
fig = plot(times(4,:),times(3,:));
title('Array Size vs X faster');
xlabel('array size (number of RxC
saveas(fig, 'size_vs_speedup.png');

figure
fig = plot(times(4,:),times(1,:),times(4,:),times(2,:));
title('Array Size vs time (ms)');
legend({'cpu', 'gpu'}, 'Location', 'northwest');
saveas(fig, 'size_vs_time.png');